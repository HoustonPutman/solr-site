<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>Learning To Rank | Apache Solr Reference Guide</title>

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/lavish-bootstrap.css">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/theme-solr.css">
<link rel="stylesheet" href="css/ref-guide.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="Apache Solr Reference Guide" href="https://home.apache.org/~ctargett/RefGuidePOC/jekyll-full/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // we do *NOT* want cookies used to save the current stage of the sidebar
                             // instead the code in sidebar.html will ensure that the current page
                             // (and it's ancestors) are "active" on page load
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="apache-solr-reference-guide.html">&nbsp;<span class="projectTitle"> Solr Ref Guide 7.0</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- Link to Solr website -->
                <li><a href="https://lucene.apache.org/solr/news" target="_blank">Solr News</a></li>
                <!-- Solr Resources dropdown -->
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Solr Resources<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                       <li><a href="https://lucene.apache.org/solr/7_0_0//solr-core/index.html" target="_blank">Solr Javadocs</a></li>
                       <li><a href="https://git1-us-west.apache.org/repos/asf?p=lucene-solr.git" target="_blank">Lucene/Solr Source Code</a></li>
                       <li><a href="https://lucene.apache.org/solr/resources.html#community" target="_blank">Solr Community Links</a></li>
                    </ul>
                </li>
                
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Learning To Rank">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div class="col-lg-12">&nbsp;</div>
  <!-- Content Row -->
  <div class="row">
    <!-- Sidebar Column -->
    <div class="col-md-3">
      

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle">Apache Solr Reference Guide <!-- TODO: version from site.data --></li>
  
  <li class="sb-level1">
    <a href="about-this-guide.html">About This Guide</a>
    
  </li>
  
  <li class="sb-level1">
    <a href="getting-started.html">Getting Started</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="installing-solr.html">Installing Solr</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="running-solr.html">Running Solr</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="a-quick-overview.html">A Quick Overview</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="a-step-closer.html">A Step Closer</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="solr-control-script-reference.html">Solr Control Script Reference</a>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="upgrading-solr.html">Upgrading Solr</a>
    
  </li>
  
  <li class="sb-level1">
    <a href="using-the-solr-administration-user-interface.html">Using the Solr Administration User Interface</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="overview-of-the-solr-admin-ui.html">Overview of the Solr Admin UI</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="getting-assistance.html">Getting Assistance</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="logging.html">Logging</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="cloud-screens.html">Cloud Screens</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="collections-core-admin.html">Collections / Core Admin</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="java-properties.html">Java Properties</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="thread-dump.html">Thread Dump</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="collection-specific-tools.html">Collection-Specific Tools</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="analysis-screen.html">Analysis Screen</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="dataimport-screen.html">Dataimport Screen</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="documents-screen.html">Documents Screen</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="files-screen.html">Files Screen</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="query-screen.html">Query Screen</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="stream-screen.html">Stream Screen</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="schema-browser-screen.html">Schema Browser Screen</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="core-specific-tools.html">Core-Specific Tools</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="ping.html">Ping</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="plugins-stats-screen.html">Plugins &amp; Stats Screen</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="replication-screen.html">Replication Screen</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="segments-info.html">Segments Info</a>
            
          </li>
          
        </ul>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="documents-fields-and-schema-design.html">Documents, Fields, and Schema Design</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="overview-of-documents-fields-and-schema-design.html">Overview of Documents, Fields, and Schema Design</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="solr-field-types.html">Solr Field Types</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="field-type-definitions-and-properties.html">Field Type Definitions and Properties</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="field-types-included-with-solr.html">Field Types Included with Solr</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="working-with-currencies-and-exchange-rates.html">Working with Currencies and Exchange Rates</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="working-with-dates.html">Working with Dates</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="working-with-enum-fields.html">Working with Enum Fields</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="working-with-external-files-and-processes.html">Working with External Files and Processes</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="field-properties-by-use-case.html">Field Properties by Use Case</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="defining-fields.html">Defining Fields</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="copying-fields.html">Copying Fields</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="dynamic-fields.html">Dynamic Fields</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="other-schema-elements.html">Other Schema Elements</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="schema-api.html">Schema API</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="putting-the-pieces-together.html">Putting the Pieces Together</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="docvalues.html">DocValues</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="schemaless-mode.html">Schemaless Mode</a>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="understanding-analyzers-tokenizers-and-filters.html">Understanding Analyzers, Tokenizers, and Filters</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="analyzers.html">Analyzers</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="about-tokenizers.html">About Tokenizers</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="about-filters.html">About Filters</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="tokenizers.html">Tokenizers</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="filter-descriptions.html">Filter Descriptions</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="charfilterfactories.html">CharFilterFactories</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="language-analysis.html">Language Analysis</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="phonetic-matching.html">Phonetic Matching</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="running-your-analyzer.html">Running Your Analyzer</a>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="indexing-and-basic-data-operations.html">Indexing and Basic Data Operations</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="introduction-to-solr-indexing.html">Introduction to Solr Indexing</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="post-tool.html">Post Tool</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="uploading-data-with-index-handlers.html">Uploading Data with Index Handlers</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="transforming-and-indexing-custom-json.html">Transforming and Indexing Custom JSON</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="uploading-data-with-solr-cell-using-apache-tika.html">Uploading Data with Solr Cell using Apache Tika</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="uploading-structured-data-store-data-with-the-data-import-handler.html">Uploading Structured Data Store Data with the Data Import Handler</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="updating-parts-of-documents.html">Updating Parts of Documents</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="detecting-languages-during-indexing.html">Detecting Languages During Indexing</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="de-duplication.html">De-Duplication</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="content-streams.html">Content Streams</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="uima-integration.html">UIMA Integration</a>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="searching.html">Searching</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="overview-of-searching-in-solr.html">Overview of Searching in Solr</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="velocity-search-ui.html">Velocity Search UI</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="relevance.html">Relevance</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="query-syntax-and-parsing.html">Query Syntax and Parsing</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="common-query-parameters.html">Common Query Parameters</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="the-standard-query-parser.html">The Standard Query Parser</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="the-dismax-query-parser.html">The DisMax Query Parser</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="the-extended-dismax-query-parser.html">The Extended DisMax Query Parser</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="function-queries.html">Function Queries</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="local-parameters-in-queries.html">Local Parameters in Queries</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="other-parsers.html">Other Parsers</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="faceting.html">Faceting</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="blockjoin-faceting.html">BlockJoin Faceting</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="highlighting.html">Highlighting</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="spell-checking.html">Spell Checking</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="query-re-ranking.html">Query Re-Ranking</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="learning-to-rank.html">Learning To Rank</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="transforming-result-documents.html">Transforming Result Documents</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="suggester.html">Suggester</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="morelikethis.html">MoreLikeThis</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="pagination-of-results.html">Pagination of Results</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="collapse-and-expand-results.html">Collapse and Expand Results</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="result-grouping.html">Result Grouping</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="result-clustering.html">Result Clustering</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="spatial-search.html">Spatial Search</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="the-terms-component.html">The Terms Component</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="the-term-vector-component.html">The Term Vector Component</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="the-stats-component.html">The Stats Component</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="the-query-elevation-component.html">The Query Elevation Component</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="response-writers.html">Response Writers</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="velocity-response-writer.html">Velocity Response Writer</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="near-real-time-searching.html">Near Real Time Searching</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="realtime-get.html">RealTime Get</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="exporting-result-sets.html">Exporting Result Sets</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="streaming-expressions.html">Streaming Expressions</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="graph-traversal.html">Graph Traversal</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="parallel-sql-interface.html">Parallel SQL Interface</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="solr-jdbc-dbvisualizer.html">Solr JDBC - DbVisualizer</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="solr-jdbc-squirrel-sql.html">Solr JDBC - SQuirreL SQL</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="solr-jdbc-apache-zeppelin.html">Solr JDBC - Apache Zeppelin</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="solr-jdbc-python-jython.html">Solr JDBC - Python/Jython</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="solr-jdbc-r.html">Solr JDBC - R</a>
            
          </li>
          
        </ul>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="the-well-configured-solr-instance.html">The Well-Configured Solr Instance</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="configuring-solrconfig-xml.html">Configuring solrconfig.xml</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="datadir-and-directoryfactory-in-solrconfig.html">DataDir and DirectoryFactory in SolrConfig</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="lib-directives-in-solrconfig.html">Lib Directives in SolrConfig</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="schema-factory-definition-in-solrconfig.html">Schema Factory Definition in SolrConfig</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="indexconfig-in-solrconfig.html">IndexConfig in SolrConfig</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="requesthandlers-and-searchcomponents-in-solrconfig.html">RequestHandlers and SearchComponents in SolrConfig</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="initparams-in-solrconfig.html">InitParams in SolrConfig</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="updatehandlers-in-solrconfig.html">UpdateHandlers in SolrConfig</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="query-settings-in-solrconfig.html">Query Settings in SolrConfig</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="requestdispatcher-in-solrconfig.html">RequestDispatcher in SolrConfig</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="update-request-processors.html">Update Request Processors</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="codec-factory.html">Codec Factory</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="solr-cores-and-solr-xml.html">Solr Cores and solr.xml</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="format-of-solr-xml.html">Format of solr.xml</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="defining-core-properties.html">Defining core.properties</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="coreadmin-api.html">CoreAdmin API</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="config-sets.html">Config Sets</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="configuration-apis.html">Configuration APIs</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="blob-store-api.html">Blob Store API</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="config-api.html">Config API</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="request-parameters-api.html">Request Parameters API</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="managed-resources.html">Managed Resources</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="implicit-requesthandlers.html">Implicit RequestHandlers</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="solr-plugins.html">Solr Plugins</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="adding-custom-plugins-in-solrcloud-mode.html">Adding Custom Plugins in SolrCloud Mode</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="jvm-settings.html">JVM Settings</a>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="managing-solr.html">Managing Solr</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="taking-solr-to-production.html">Taking Solr to Production</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="securing-solr.html">Securing Solr</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="authentication-and-authorization-plugins.html">Authentication and Authorization Plugins</a>
            
            <ul>
              
              <li class="sb-level4">
                <a href="basic-authentication-plugin.html">Basic Authentication Plugin</a>
                
              </li>
              
              <li class="sb-level4">
                <a href="hadoop-authentication-plugin.html">Hadoop Authentication Plugin</a>
                
              </li>
              
              <li class="sb-level4">
                <a href="kerberos-authentication-plugin.html">Kerberos Authentication Plugin</a>
                
              </li>
              
              <li class="sb-level4">
                <a href="rule-based-authorization-plugin.html">Rule-Based Authorization Plugin</a>
                
              </li>
              
            </ul>
            
          </li>
          
          <li class="sb-level3">
            <a href="enabling-ssl.html">Enabling SSL</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="running-solr-on-hdfs.html">Running Solr on HDFS</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="making-and-restoring-backups.html">Making and Restoring Backups</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="configuring-logging.html">Configuring Logging</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="using-jmx-with-solr.html">Using JMX with Solr</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="mbean-request-handler.html">MBean Request Handler</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="performance-statistics-reference.html">Performance Statistics Reference</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="metrics-reporting.html">Metrics Reporting</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="v2-api.html">v2 API</a>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="solrcloud.html">SolrCloud</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="getting-started-with-solrcloud.html">Getting Started with SolrCloud</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="how-solrcloud-works.html">How SolrCloud Works</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="shards-and-indexing-data-in-solrcloud.html">Shards and Indexing Data in SolrCloud</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="distributed-requests.html">Distributed Requests</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="read-and-write-side-fault-tolerance.html">Read and Write Side Fault Tolerance</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="solrcloud-configuration-and-parameters.html">SolrCloud Configuration and Parameters</a>
        
        <ul>
          
          <li class="sb-level3">
            <a href="setting-up-an-external-zookeeper-ensemble.html">Setting Up an External ZooKeeper Ensemble</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="using-zookeeper-to-manage-configuration-files.html">Using ZooKeeper to Manage Configuration Files</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="zookeeper-access-control.html">ZooKeeper Access Control</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="collections-api.html">Collections API</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="parameter-reference.html">Parameter Reference</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="command-line-utilities.html">Command Line Utilities</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="solrcloud-with-legacy-configuration-files.html">SolrCloud with Legacy Configuration Files</a>
            
          </li>
          
          <li class="sb-level3">
            <a href="configsets-api.html">ConfigSets API</a>
            
          </li>
          
        </ul>
        
      </li>
      
      <li class="sb-level2">
        <a href="rule-based-replica-placement.html">Rule-based Replica Placement</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="cross-data-center-replication-cdcr-.html">Cross Data Center Replication (CDCR)</a>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="legacy-scaling-and-distribution.html">Legacy Scaling and Distribution</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="introduction-to-scaling-and-distribution.html">Introduction to Scaling and Distribution</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="distributed-search-with-index-sharding.html">Distributed Search with Index Sharding</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="index-replication.html">Index Replication</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="combining-distribution-and-replication.html">Combining Distribution and Replication</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="merging-indexes.html">Merging Indexes</a>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="client-apis.html">Client APIs</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="introduction-to-client-apis.html">Introduction to Client APIs</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="choosing-an-output-format.html">Choosing an Output Format</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="client-api-lineup.html">Client API Lineup</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="using-javascript.html">Using JavaScript</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="using-python.html">Using Python</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="using-solrj.html">Using SolrJ</a>
        
      </li>
      
      <li class="sb-level2">
        <a href="using-solr-from-ruby.html">Using Solr From Ruby</a>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="major-changes-from-solr-5-to-solr-6.html">Major Changes from Solr 5 to Solr 6</a>
    
  </li>
  
  <li class="sb-level1">
    <a href="upgrading-a-solr-cluster.html">Upgrading a Solr Cluster</a>
    
    <ul>
      
      <li class="sb-level2">
        <a href="indexupgrader-tool.html">IndexUpgrader Tool</a>
        
      </li>
      
    </ul>
    
  </li>
  
  <li class="sb-level1">
    <a href="further-assistance.html">Further Assistance</a>
    
  </li>
  
  <li class="sb-level1">
    <a href="solr-glossary.html">Solr Glossary</a>
    
  </li>
  
  <li class="sb-level1">
    <a href="errata.html">Errata</a>
    
  </li>
  
</ul>


<!-- set the 'active' class on the current page and ancestors -->
<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("#mysidebar a[href='learning-to-rank.html']").parents('li').toggleClass("active", true);</script>
<!-- set the 'current' class on the current page and 'current-tree' on the current page + it's ancestors -->
<!-- this can let us do css highlighting of the current page in the sidebar even if/when the user clicks around in the sidebar causing other sidebar elements to be 'active' -->
<script>
  $("#mysidebar a[href='learning-to-rank.html']").parent('li').toggleClass("current", true);
  $("#mysidebar a[href='learning-to-rank.html']").parents('li').toggleClass("current-tree", true);
</script>

    </div>
    <!-- Content Column -->
    <div class="col-md-9">
      <div class="post-header">
   <h1 class="post-title-main">Learning To Rank</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 2, listType: 'ul', showSpeed: 0, headers: 'h2,h3' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})

});
</script>

<div id="toc"></div>

    

<div id="main-content">
  <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>With the <strong>Learning To Rank</strong> (or <strong>LTR</strong> for short) contrib module you can configure and run machine learned ranking models in Solr. The module also supports feature extraction inside Solr. The only thing you need to do outside Solr is train your own ranking model.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="LearningToRank-Concepts">Concepts</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="LearningToRank-Re-Ranking">Re-Ranking</h3>
<div class="paragraph">
<p>Re-Ranking allows you to run a simple query for matching documents and then re-rank the top N documents using the scores from a different, complex query. This page describes the use of <strong>LTR</strong> complex queries, information on other rank queries included in the Solr distribution can be found on the <a href="query-re-ranking.html#query-re-ranking">Query Re-Ranking</a> page.</p>
</div>
</div>
<div class="sect2">
<h3 id="LearningToRank-LearningToRank">Learning To Rank</h3>
<div class="paragraph">
<p>In information retrieval systems, <a href="https://en.wikipedia.org/wiki/Learning_to_rank">Learning to Rank</a> is used to re-rank the top N retrieved documents using trained machine learning models. The hope is that such sophisticated models can make more nuanced ranking decisions than standard ranking functions like <a href="https://en.wikipedia.org/wiki/Tf%E2%80%93idf">TF-IDF</a> or <a href="https://en.wikipedia.org/wiki/Okapi_BM25">BM25</a>.</p>
</div>
<div class="sect3">
<h4 id="LearningToRank-Model">Model</h4>
<div class="paragraph">
<p>A ranking model computes the scores used to rerank documents. Irrespective of any particular algorithm or implementation, a ranking model&#8217;s computation can use three types of inputs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>parameters that represent the scoring algorithm</p>
</li>
<li>
<p>features that represent the document being scored</p>
</li>
<li>
<p>features that represent the query for which the document is being scored</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="LearningToRank-Feature">Feature</h4>
<div class="paragraph">
<p>A feature is a value, a number, that represents some quantity or quality of the document being scored or of the query for which documents are being scored. For example documents often have a 'recency' quality and 'number of past purchases' might be a quantity that is passed to Solr as part of the search query.</p>
</div>
</div>
<div class="sect3">
<h4 id="LearningToRank-Normalizer">Normalizer</h4>
<div class="paragraph">
<p>Some ranking models expect features on a particular scale. A normalizer can be used to translate arbitrary feature values into normalized values e.g. on a 0..1 or 0..100 scale.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="LearningToRank-Training">Training</h3>
<div class="sect3">
<h4 id="LearningToRank-Featureengineering">Feature engineering</h4>
<div class="paragraph">
<p>The LTR contrib module includes several feature classes as well as support for custom features. Each feature class&#8217;s javadocs contain an example to illustrate use of that class. The process of <a href="https://en.wikipedia.org/wiki/Feature_engineering">feature engineering</a> itself is then entirely up to your domain expertise and creativity.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Feature</th>
<th class="tableblock halign-left valign-top">Class</th>
<th class="tableblock halign-left valign-top">Example parameters</th>
<th class="tableblock halign-left valign-top"><a href="#LearningToRank-ExternalFeatureInformation">External Feature Information</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">field length</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/feature/FieldLengthFeature.html">FieldLengthFeature</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"field":"title"}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not (yet) supported</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">field value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/feature/FieldValueFeature.html">FieldValueFeature</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"field":"hits"}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not (yet) supported</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">original score</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/feature/OriginalScoreFeature.html">OriginalScoreFeature</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not applicable</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">solr query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/feature/SolrFeature.html">SolrFeature</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"q":"{!func}</code> <code>recip(ms(NOW,last_modified)</code> <code>,3.16e-11,1,1)"}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">supported</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">solr filter query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/feature/SolrFeature.html">SolrFeature</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"fq":["{!terms f=category}book"]}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">supported</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">solr query + filter query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/feature/SolrFeature.html">SolrFeature</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"q":"{!func}</code> <code>recip(ms(NOW,last_modified),</code> <code>3.16e-11,1,1)",</code> <code>"fq":["{!terms f=category}book"]}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">supported</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/feature/ValueFeature.html">ValueFeature</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"value":"${userFromMobile}","required":true}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">supported</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(custom)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(custom class extending <a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/feature/Feature.html">Feature</a>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Normalizer</th>
<th class="tableblock halign-left valign-top">Class</th>
<th class="tableblock halign-left valign-top">Example parameters</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/norm/IdentityNormalizer.html">IdentityNormalizer</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MinMax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/norm/MinMaxNormalizer.html">MinMaxNormalizer</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"min":"0", "max":"50" }</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/norm/StandardNormalizer.html">StandardNormalizer</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"avg":"42","std":"6"}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(custom)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(custom class extending <a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/norm/Normalizer.html">Normalizer</a>)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="LearningToRank-Featureextraction">Feature extraction</h4>
<div class="paragraph">
<p>The ltr contrib module includes a <a href="transforming-result-documents.html#transforming-result-documents">[features</a> transformer] to support the calculation and return of feature values for <a href="https://en.wikipedia.org/wiki/Feature_extraction">feature extraction</a> purposes including and especially when you do not yet have an actual reranking model.</p>
</div>
</div>
<div class="sect3">
<h4 id="LearningToRank-Featureselectionandmodeltraining">Feature selection and model training</h4>
<div class="paragraph">
<p>Feature selection and model training take place offline and outside Solr. The ltr contrib module supports two generalized forms of models as well as custom models. Each model class&#8217;s javadocs contain an example to illustrate configuration of that class. In the form of JSON files your trained model or models (e.g. different models for different customer geographies) can then be directly uploaded into Solr using provided REST APIs.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">General form</th>
<th class="tableblock halign-left valign-top">Class</th>
<th class="tableblock halign-left valign-top">Specific examples</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linear</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/model/LinearModel.html">LinearModel</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RankSVM, Pranking</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiple Additive Trees</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/model/MultipleAdditiveTreesModel.html">MultipleAdditiveTreesModel</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LambdaMART, Gradient Boosted Regression Trees (GBRT)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(custom)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(custom class extending <a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/model/LTRScoringModel.html">LTRScoringModel</a>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(not applicable)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="LearningToRank-QuickStartExample">Quick Start Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>"techproducts"</code> example included with Solr is pre-configured with the plugins required for learning-to-rank, but they are disabled by default.</p>
</div>
<div class="paragraph">
<p>To enable the plugins, please specify the <code>"solr.ltr.enabled"</code> JVM System Property when running the example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="plain">bin/solr start -e techproducts -Dsolr.ltr.enabled=true</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="LearningToRank-Uploadingfeatures">Uploading features</h3>
<div class="paragraph">
<p>To upload features in a <code>/path/myFeatures.json</code> file, please run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">curl -XPUT <span style="color: #BA2121">&#39;http://localhost:8983/solr/techproducts/schema/feature-store&#39;</span> --data-binary <span style="color: #BA2121">&quot;@/path/myFeatures.json&quot;</span> -H <span style="color: #BA2121">&#39;Content-type:application/json&#39;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To view the features you just uploaded please open the following URL in a browser:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:8983/solr/techproducts/schema/feature-store/" class="bare">http://localhost:8983/solr/techproducts/schema/feature-store/</a><em>DEFAULT</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example: /path/myFeatures.json</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #666666">[</span>
  <span style="color: #666666">{</span>
    <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;documentRecency&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;class&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;org.apache.solr.ltr.feature.SolrFeature&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;params&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span>
      <span style="color: #BA2121">&quot;q&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;{!func}recip( ms(NOW,last_modified), 3.16e-11, 1, 1)&quot;</span>
    <span style="color: #666666">}</span>
  <span style="color: #666666">},</span>
  <span style="color: #666666">{</span>
    <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;isBook&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;class&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;org.apache.solr.ltr.feature.SolrFeature&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;params&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span>
      <span style="color: #BA2121">&quot;fq&quot;</span><span style="color: #666666">:</span> <span style="color: #666666">[</span> <span style="color: #BA2121">&quot;{!terms f=cat}book&quot;</span> <span style="color: #666666">]</span>
    <span style="color: #666666">}</span>
  <span style="color: #666666">},</span>
  <span style="color: #666666">{</span>
    <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;originalScore&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;class&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;org.apache.solr.ltr.feature.OriginalScoreFeature&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;params&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{}</span>
  <span style="color: #666666">}</span>
<span style="color: #666666">]</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="LearningToRank-Extractingfeatures">Extracting features</h3>
<div class="paragraph">
<p>To extract features as part of a query, add <code>[features]</code> to the <code>fl</code> parameter, for example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:8983/solr/techproducts/query?q=test&amp;fl=id,score,%5Bfeatures%5D" class="bare">http://localhost:8983/solr/techproducts/query?q=test&amp;fl=id,score,%5Bfeatures%5D</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The output XML will include feature values as a comma-separated list, resembling the output shown here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml">{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:0,
    &quot;params&quot;:{
      &quot;q&quot;:&quot;test&quot;,
      &quot;fl&quot;:&quot;id,score,[features]&quot;}},
  &quot;response&quot;:{&quot;numFound&quot;:2,&quot;start&quot;:0,&quot;maxScore&quot;:1.959392,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;GB18030TEST&quot;,
        &quot;score&quot;:1.959392,
        &quot;[features]&quot;:&quot;documentRecency=0.020893794,isBook=0.0,originalScore=1.959392&quot;},
      {
        &quot;id&quot;:&quot;UTF8TEST&quot;,
        &quot;score&quot;:1.5513437,
        &quot;[features]&quot;:&quot;documentRecency=0.020893794,isBook=0.0,originalScore=1.5513437&quot;}]
  }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="LearningToRank-Uploadingamodel">Uploading a model</h3>
<div class="paragraph">
<p>To upload the model in a <code>/path/myModel.json</code> file, please run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">curl -XPUT <span style="color: #BA2121">&#39;http://localhost:8983/solr/techproducts/schema/model-store&#39;</span> --data-binary <span style="color: #BA2121">&quot;@/path/myModel.json&quot;</span> -H <span style="color: #BA2121">&#39;Content-type:application/json&#39;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To view the model you just uploaded please open the following URL in a browser:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:8983/solr/techproducts/schema/model-store" class="bare">http://localhost:8983/solr/techproducts/schema/model-store</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example: /path/myModel.json</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #666666">{</span>
  <span style="color: #BA2121">&quot;class&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;org.apache.solr.ltr.model.LinearModel&quot;</span><span style="color: #666666">,</span>
  <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;myModel&quot;</span><span style="color: #666666">,</span>
  <span style="color: #BA2121">&quot;features&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">[</span>
    <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;documentRecency&quot;</span> <span style="color: #666666">},</span>
    <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;isBook&quot;</span> <span style="color: #666666">},</span>
    <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;originalScore&quot;</span> <span style="color: #666666">}</span>
  <span style="color: #666666">],</span>
  <span style="color: #BA2121">&quot;params&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span>
    <span style="color: #BA2121">&quot;weights&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span>
      <span style="color: #BA2121">&quot;documentRecency&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">1.0,</span>
      <span style="color: #BA2121">&quot;isBook&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">0.1,</span>
      <span style="color: #BA2121">&quot;originalScore&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">0.5</span>
    <span style="color: #666666">}</span>
  <span style="color: #666666">}</span>
<span style="color: #666666">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="LearningToRank-Runningarerankquery">Running a rerank query</h3>
<div class="paragraph">
<p>To rerank the results of a query, add the <code>rq</code> parameter to your search, for example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:8983/solr/techproducts/query?q=test&amp;rq=%7B!ltr%20model=myModel%20reRankDocs=100%7D&amp;fl=id,score">http://localhost:8983/solr/techproducts/query?q=test&amp;rq=\{!ltr model=myModel reRankDocs=100}&amp;fl=id</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The addition of the <code>rq</code> parameter will not change the output XML of the search.</p>
</div>
<div class="paragraph">
<p>To obtain the feature values computed during reranking, add <code>[features]</code> to the <code>fl</code> parameter, for example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:8983/solr/techproducts/query?q=test&amp;rq=%7B!ltr%20model=myModel%20reRankDocs=100%7D&amp;fl=id,score,%5Bfeatures%5D">http://localhost:8983/solr/techproducts/query?q=test&amp;rq=\{!ltr model=myModel reRankDocs=100}&amp;fl=id</a>]</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The output XML will include feature values as a comma-separated list, resembling the output shown here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml">{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:0,
    &quot;params&quot;:{
      &quot;q&quot;:&quot;test&quot;,
      &quot;fl&quot;:&quot;id,score,[features]&quot;,
      &quot;rq&quot;:&quot;{!ltr model=myModel reRankDocs=100}&quot;}},
  &quot;response&quot;:{&quot;numFound&quot;:2,&quot;start&quot;:0,&quot;maxScore&quot;:1.0005897,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;GB18030TEST&quot;,
        &quot;score&quot;:1.0005897,
        &quot;[features]&quot;:&quot;documentRecency=0.020893792,isBook=0.0,originalScore=1.959392&quot;},
      {
        &quot;id&quot;:&quot;UTF8TEST&quot;,
        &quot;score&quot;:0.79656565,
        &quot;[features]&quot;:&quot;documentRecency=0.020893792,isBook=0.0,originalScore=1.5513437&quot;}]
  }}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="LearningToRank-ExternalFeatureInformation">External Feature Information</h3>
<div class="paragraph">
<p>The <a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/feature/ValueFeature.html">ValueFeature</a> and <a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/feature/SolrFeature.html">SolrFeature</a> classes support the use of external feature information, <code>efi</code> for short.</p>
</div>
<div class="sect3">
<h4 id="LearningToRank-Uploadingfeatures.1">Uploading features</h4>
<div class="paragraph">
<p>To upload features in a <code>/path/myEfiFeatures.json</code> file, please run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">curl -XPUT <span style="color: #BA2121">&#39;http://localhost:8983/solr/techproducts/schema/feature-store&#39;</span> --data-binary <span style="color: #BA2121">&quot;@/path/myEfiFeatures.json&quot;</span> -H <span style="color: #BA2121">&#39;Content-type:application/json&#39;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To view the features you just uploaded please open the following URL in a browser:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:8983/solr/techproducts/schema/feature-store/myEfiFeatureStore" class="bare">http://localhost:8983/solr/techproducts/schema/feature-store/myEfiFeatureStore</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example: /path/myEfiFeatures.json</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #666666">[</span>
  <span style="color: #666666">{</span>
    <span style="color: #BA2121">&quot;store&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;myEfiFeatureStore&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;isPreferredManufacturer&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;class&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;org.apache.solr.ltr.feature.SolrFeature&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;params&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;fq&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">[</span> <span style="color: #BA2121">&quot;{!field f=manu}${preferredManufacturer}&quot;</span> <span style="color: #666666">]</span> <span style="color: #666666">}</span>
  <span style="color: #666666">},</span>
  <span style="color: #666666">{</span>
    <span style="color: #BA2121">&quot;store&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;myEfiFeatureStore&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;userAnswerValue&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;class&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;org.apache.solr.ltr.feature.ValueFeature&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;params&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;value&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;${answer:42}&quot;</span> <span style="color: #666666">}</span>
  <span style="color: #666666">},</span>
  <span style="color: #666666">{</span>
    <span style="color: #BA2121">&quot;store&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;myEfiFeatureStore&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;userFromMobileValue&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;class&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;org.apache.solr.ltr.feature.ValueFeature&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;params&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;value&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;${fromMobile}&quot;</span><span style="color: #666666">,</span> <span style="color: #BA2121">&quot;required&quot;</span> <span style="color: #666666">:</span> <span style="color: #008000; font-weight: bold">true</span> <span style="color: #666666">}</span>
  <span style="color: #666666">},</span>
  <span style="color: #666666">{</span>
    <span style="color: #BA2121">&quot;store&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;myEfiFeatureStore&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;userTextCat&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;class&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;org.apache.solr.ltr.feature.SolrFeature&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;params&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;q&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;{!field f=cat}${text}&quot;</span> <span style="color: #666666">}</span>
  <span style="color: #666666">}</span>
<span style="color: #666666">]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As an aside, you may have noticed that the <code>myEfiFeatures.json</code> example uses <code>"store":"myEfiFeatureStore"</code> attributes: read more about feature `store`s in the <a href="#LearningToRank-Lifecycle">Lifecycle</a> section of this page.</p>
</div>
</div>
<div class="sect3">
<h4 id="LearningToRank-Extractingfeatures.1">Extracting features</h4>
<div class="paragraph">
<p>To extract <code>myEfiFeatureStore</code> features as part of a query, add <code>efi.*</code> parameters to the <code>[features]</code> part of the <code>fl</code> parameter, for example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>link:[] <a href="http://localhost:8983/solr/techproducts/query?q=test&amp;fl=id,cat,manu,score,%5Bfeatures%20store=myEfiFeatureStore%20efi.text=test%20efi.preferredManufacturer=Apache%20efi.fromMobile=1%5D">http://localhost:8983/solr/techproducts/query?q=test&amp;fl=id</a>]</p>
</li>
<li>
<p>link:[] <a href="http://localhost:8983/solr/techproducts/query?q=test&amp;fl=id,cat,manu,score,%5Bfeatures%20store=myEfiFeatureStore%20efi.text=test%20efi.preferredManufacturer=Apache%20efi.fromMobile=0%20efi.answer=13%5D">http://localhost:8983/solr/techproducts/query?q=test&amp;fl=id</a>]</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="LearningToRank-Uploadingamodel.1">Uploading a model</h4>
<div class="paragraph">
<p>To upload the model in a <code>/path/myEfiModel.json</code> file, please run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">curl -XPUT <span style="color: #BA2121">&#39;http://localhost:8983/solr/techproducts/schema/model-store&#39;</span> --data-binary <span style="color: #BA2121">&quot;@/path/myEfiModel.json&quot;</span> -H <span style="color: #BA2121">&#39;Content-type:application/json&#39;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To view the model you just uploaded please open the following URL in a browser:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:8983/solr/techproducts/schema/model-store" class="bare">http://localhost:8983/solr/techproducts/schema/model-store</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example: /path/myEfiModel.json</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #666666">{</span>
  <span style="color: #BA2121">&quot;store&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;myEfiFeatureStore&quot;</span><span style="color: #666666">,</span>
  <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;myEfiModel&quot;</span><span style="color: #666666">,</span>
  <span style="color: #BA2121">&quot;class&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;org.apache.solr.ltr.model.LinearModel&quot;</span><span style="color: #666666">,</span>
  <span style="color: #BA2121">&quot;features&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">[</span>
    <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;isPreferredManufacturer&quot;</span> <span style="color: #666666">},</span>
    <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;userAnswerValue&quot;</span> <span style="color: #666666">},</span>
    <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;userFromMobileValue&quot;</span> <span style="color: #666666">},</span>
    <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;userTextCat&quot;</span> <span style="color: #666666">}</span>
  <span style="color: #666666">],</span>
  <span style="color: #BA2121">&quot;params&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span>
    <span style="color: #BA2121">&quot;weights&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span>
      <span style="color: #BA2121">&quot;isPreferredManufacturer&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">0.2,</span>
      <span style="color: #BA2121">&quot;userAnswerValue&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">1.0,</span>
      <span style="color: #BA2121">&quot;userFromMobileValue&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">1.0,</span>
      <span style="color: #BA2121">&quot;userTextCat&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">0.1</span>
    <span style="color: #666666">}</span>
  <span style="color: #666666">}</span>
<span style="color: #666666">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="LearningToRank-Runningarerankquery.1">Running a rerank query</h4>
<div class="paragraph">
<p>To obtain the feature values computed during reranking, add <code>[features]</code> to the <code>fl</code> parameter and <code>efi.*</code> parameters to the <code>rq</code> parameter, for example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:8983/solr/techproducts/query?q=test&amp;rq=%7B!ltr%20model=myEfiModel%20efi.text=test%20efi.preferredManufacturer=Apache%20efi.fromMobile=1%7D&amp;fl=id,cat,manu,score,%5Bfeatures%5D">http://localhost:8983/solr/techproducts/query?q=test&amp;rq=\{!ltr model=myEfiModel efi.text=test efi.preferredManufacturer=Apache efi.fromMobile=1}&amp;fl=id</a>] link:[]</p>
</li>
<li>
<p>link:[]<a href="http://localhost:8983/solr/techproducts/query?q=test&amp;rq=%7B!ltr%20model=myEfiModel%20efi.text=test%20efi.preferredManufacturer=Apache%20efi.fromMobile=0%20efi.answer=13%7D&amp;fl=id,cat,manu,score,%5Bfeatures%5D">http://localhost:8983/solr/techproducts/query?q=test&amp;rq=\{!ltr model=myEfiModel efi.text=test efi.preferredManufacturer=Apache efi.fromMobile=0 efi.answer=13}&amp;fl=id</a>]</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Notice the absence of <code>efi.*</code> parameters in the <code>[features]</code> part of the <code>fl</code> parameter.</p>
</div>
</div>
<div class="sect3">
<h4 id="LearningToRank-Extractingfeatureswhilstreranking">Extracting features whilst reranking</h4>
<div class="paragraph">
<p>To extract features for <code>myEfiFeatureStore&#8217;s features whilst still reranking with `myModel</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:8983/solr/techproducts/query?q=test&amp;rq=%7B!ltr%20model=myModel%7D&amp;fl=id,cat,manu,score,%5Bfeatures%20store=myEfiFeatureStore%20efi.text=test%20efi.preferredManufacturer=Apache%20efi.fromMobile=1%5D">http://localhost:8983/solr/techproducts/query?q=test&amp;rq=\{!ltr model=myModel}&amp;fl=id</a>] link:[]</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Notice the absence of <code>efi.<strong></code> parameters in the <code>rq</code> parameter (because <code>myModel</code> does not use <code>efi</code> feature) and the presence of <code>efi.</strong></code> parameters in the <code>[features]</code> part of the <code>fl</code> parameter (because <code>myEfiFeatureStore</code> contains <code>efi</code> features).</p>
</div>
<div class="paragraph">
<p>Read more about model evolution in the <a href="#LearningToRank-Lifecycle">Lifecycle</a> section of this page.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="LearningToRank-Trainingexample">Training example</h3>
<div class="paragraph">
<p>Example training data and a demo 'train and upload model' script can be found in the <code>solr/contrib/ltr/example</code> folder in the <a href="https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git">Apache lucene-solr git repository</a> which is mirrored on <a href="https://github.com/apache/lucene-solr/tree/releases/lucene-solr/6.4.0/solr/contrib/ltr/example">github.com</a> (the <code>solr/contrib/ltr/example</code> folder is not shipped in the solr binary release).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="LearningToRank-Installation">Installation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The ltr contrib module requires the <code>dist/solr-ltr-*.jar</code> JARs.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="LearningToRank-Configuration">Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Learning-To-Rank is a contrib module and therefore its plugins must be configured in <code>solrconfig.xml</code>.</p>
</div>
<div class="sect2">
<h3 id="LearningToRank-Minimumrequirements">Minimum requirements</h3>
<div class="ulist">
<ul>
<li>
<p>Include the required contrib JARs. Note that by default paths are relative to the Solr core so they may need adjustments to your configuration, or an explicit specification of the <code>$solr.install.dir</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;lib</span> <span style="color: #7D9029">dir=</span><span style="color: #BA2121">&quot;${solr.install.dir:../../../..}/dist/&quot;</span> <span style="color: #7D9029">regex=</span><span style="color: #BA2121">&quot;solr-ltr-\d.*\.jar&quot;</span> <span style="color: #008000; font-weight: bold">/&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Declaration of the <code>ltr</code> query parser.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #666666">&lt;</span>queryParser name<span style="color: #666666">=</span><span style="color: #BA2121">&quot;ltr&quot;</span> class<span style="color: #666666">=</span><span style="color: #BA2121">&quot;org.apache.solr.ltr.search.LTRQParserPlugin&quot;</span><span style="color: #666666">/&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Configuration of the feature values cache.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;cache</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;QUERY_DOC_FV&quot;</span>
       <span style="color: #7D9029">class=</span><span style="color: #BA2121">&quot;solr.search.LRUCache&quot;</span>
       <span style="color: #7D9029">size=</span><span style="color: #BA2121">&quot;4096&quot;</span>
       <span style="color: #7D9029">initialSize=</span><span style="color: #BA2121">&quot;2048&quot;</span>
       <span style="color: #7D9029">autowarmCount=</span><span style="color: #BA2121">&quot;4096&quot;</span>
       <span style="color: #7D9029">regenerator=</span><span style="color: #BA2121">&quot;solr.search.NoOpRegenerator&quot;</span> <span style="color: #008000; font-weight: bold">/&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Declaration of the <code>[features]</code> transformer.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span style="color: #008000; font-weight: bold">&lt;transformer</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;features&quot;</span> <span style="color: #7D9029">class=</span><span style="color: #BA2121">&quot;org.apache.solr.ltr.response.transform.LTRFeatureLoggerTransformerFactory&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;str</span> <span style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;fvCacheName&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>QUERY_DOC_FV<span style="color: #008000; font-weight: bold">&lt;/str&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/transformer&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="LearningToRank-Advancedoptions">Advanced options</h3>
<div class="sect3">
<h4 id="LearningToRank-LTRThreadModule">LTRThreadModule</h4>
<div class="paragraph">
<p>A thread module can be configured for the query parser and/or the transformer to parallelize the creation of feature weights. For details, please refer to the <a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/LTRThreadModule.html">LTRThreadModule</a> javadocs.</p>
</div>
</div>
<div class="sect3">
<h4 id="LearningToRank-Featurevectorcustomization">Feature vector customization</h4>
<div class="paragraph">
<p>The features transformer returns dense csv values such as <code>"featureA=0.1,featureB=0.2,featureC=0.3,featureD=0.0"</code>.</p>
</div>
<div class="paragraph">
<p>For sparse csv output such as <code>"featureA:0.1 featureB:0.2 featureC:0.3"</code> you can customize the <a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/response/transform/LTRFeatureLoggerTransformerFactory.html">feature logger transformer</a> declaration in <code>solrconfig.xml</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #666666">&lt;</span>transformer name<span style="color: #666666">=</span><span style="color: #BA2121">&quot;features&quot;</span> class<span style="color: #666666">=</span><span style="color: #BA2121">&quot;org.apache.solr.ltr.response.transform.LTRFeatureLoggerTransformerFactory&quot;</span><span style="color: #666666">&gt;</span>
  <span style="color: #666666">&lt;</span>str name<span style="color: #666666">=</span><span style="color: #BA2121">&quot;fvCacheName&quot;</span><span style="color: #666666">&gt;</span>QUERY_DOC_FV<span style="color: #666666">&lt;/</span>str<span style="color: #666666">&gt;</span>
  <span style="color: #666666">&lt;</span>str name<span style="color: #666666">=</span><span style="color: #BA2121">&quot;defaultFormat&quot;</span><span style="color: #666666">&gt;</span>sparse<span style="color: #666666">&lt;/</span>str<span style="color: #666666">&gt;</span>
  <span style="color: #666666">&lt;</span>str name<span style="color: #666666">=</span><span style="color: #BA2121">&quot;csvKeyValueDelimiter&quot;</span><span style="color: #666666">&gt;:&lt;/</span>str<span style="color: #666666">&gt;</span>
  <span style="color: #666666">&lt;</span>str name<span style="color: #666666">=</span><span style="color: #BA2121">&quot;csvFeatureSeparator&quot;</span><span style="color: #666666">&gt;</span> <span style="color: #666666">&lt;/</span>str<span style="color: #666666">&gt;</span>
<span style="color: #666666">&lt;/</span>transformer<span style="color: #666666">&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="LearningToRank-Implementationandcontributions">Implementation and contributions</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">How does Solr Learning-To-Rank work under the hood?</div>
<div class="paragraph">
<p>Please refer to the <code>ltr</code> <a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/package-summary.html">javadocs</a> for an implementation overview.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">How could i write additional models and/or features?</div>
<div class="paragraph">
<p>Contributions for further models, features and normalizers are welcome. Related links:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/model/LTRScoringModel.html">LTRScoringModel javadocs</a></p>
</li>
<li>
<p><a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/feature/Feature.html">Feature javadocs</a></p>
</li>
<li>
<p><a href="https://lucene.apache.org/solr/7_0_0//solr-ltr/org/apache/solr/ltr/norm/Normalizer.html">Normalizer javadocs</a></p>
</li>
<li>
<p><a href="http://wiki.apache.org/solr/HowToContribute" class="bare">http://wiki.apache.org/solr/HowToContribute</a></p>
</li>
<li>
<p><a href="http://wiki.apache.org/lucene-java/HowToContribute" class="bare">http://wiki.apache.org/lucene-java/HowToContribute</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="LearningToRank-Lifecycle">Lifecycle</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="LearningToRank-Featurestores">Feature stores</h3>
<div class="paragraph">
<p>It is recommended that you organise all your features into stores which are akin to namespaces:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Features within a store must be named uniquely.</p>
</li>
<li>
<p>Across stores identical or similar features can share the same name.</p>
</li>
<li>
<p>If no store name is specified then the default <code><em>DEFAULT</em></code> feature store will be used.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To discover the names of all your feature stores:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:8983/solr/techproducts/schema/feature-store" class="bare">http://localhost:8983/solr/techproducts/schema/feature-store</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To inspect the content of the <code>commonFeatureStore</code> feature store:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:8983/solr/techproducts/schema/feature-store/commonFeatureStore" class="bare">http://localhost:8983/solr/techproducts/schema/feature-store/commonFeatureStore</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="LearningToRank-Models">Models</h3>
<div class="ulist">
<ul>
<li>
<p>A model uses features from exactly one feature store.</p>
</li>
<li>
<p>If no store is specified then the default <code><em>DEFAULT</em></code> feature store will be used.</p>
</li>
<li>
<p>A model need not use all the features defined in a feature store.</p>
</li>
<li>
<p>Multiple models can use the same feature store.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To extract features for `currentFeatureStore&#8217;s features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:8983/solr/techproducts/query?q=test&amp;fl=id,score,%5Bfeatures%20store=currentFeatureStore%5D">http://localhost:8983/solr/techproducts/query?q=test&amp;fl=id</a>] link:[]</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To extract features for <code>nextFeatureStore&#8217;s features whilst reranking with `currentModel</code> based on <code>currentFeatureStore</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:8983/solr/techproducts/query?q=test&amp;rq=%7B!ltr%20model=currentModel%20reRankDocs=100%7D&amp;fl=id,score,%5Bfeatures%20store=nextFeatureStore%5D">http://localhost:8983/solr/techproducts/query?q=test&amp;rq=\{!ltr model=currentModel reRankDocs=100}&amp;fl=id</a>] link:[]</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To view all models:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:8983/solr/techproducts/schema/model-store" class="bare">http://localhost:8983/solr/techproducts/schema/model-store</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To delete the <code>currentModel</code> model:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">curl -XDELETE <span style="color: #BA2121">&#39;http://localhost:8983/solr/techproducts/schema/model-store/currentModel&#39;</span></code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A feature store must be deleted only when there are no models using it.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To delete the <code>currentFeatureStore</code> feature store:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">curl -XDELETE <span style="color: #BA2121">&#39;http://localhost:8983/solr/techproducts/schema/feature-store/currentFeatureStore&#39;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="LearningToRank-Applyingchanges">Applying changes</h3>
<div class="paragraph">
<p>The feature store and the model store are both <a href="managed-resources.html#managed-resources">Managed Resources</a>. Changes made to managed resources are not applied to the active Solr components until the Solr collection (or Solr core in single server mode) is reloaded.</p>
</div>
</div>
<div class="sect2">
<h3 id="LearningToRank-Examples">Examples</h3>
<div class="sect3">
<h4 id="LearningToRank-Onefeaturestore_multiplerankingmodels">One feature store, multiple ranking models</h4>
<div class="ulist">
<ul>
<li>
<p><code>leftModel</code> and <code>rightModel</code> both use features from <code>commonFeatureStore</code> and the only different between the two models is the weights attached to each feature.</p>
</li>
<li>
<p>Conventions used:</p>
<div class="ulist">
<ul>
<li>
<p><code>commonFeatureStore.json</code> file contains features for the <code>commonFeatureStore</code> feature store</p>
</li>
<li>
<p><code>leftModel.json</code> file contains model named <code>leftModel</code></p>
</li>
<li>
<p><code>rightModel.json</code> file contains model named <code>rightModel</code></p>
</li>
<li>
<p>The model&#8217;s features and weights are sorted alphabetically by name, this makes it easy to see what the commonalities and differences between the two models are.</p>
</li>
<li>
<p>The stores features are sorted alphabetically by name, this makes it easy to lookup features used in the models</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example: /path/commonFeatureStore.json</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #666666">[</span>
  <span style="color: #666666">{</span>
    <span style="color: #BA2121">&quot;store&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;commonFeatureStore&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;documentRecency&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;class&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;org.apache.solr.ltr.feature.SolrFeature&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;params&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span>
      <span style="color: #BA2121">&quot;q&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;{!func}recip( ms(NOW,last_modified), 3.16e-11, 1, 1)&quot;</span>
    <span style="color: #666666">}</span>
  <span style="color: #666666">},</span>
  <span style="color: #666666">{</span>
    <span style="color: #BA2121">&quot;store&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;commonFeatureStore&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;isBook&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;class&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;org.apache.solr.ltr.feature.SolrFeature&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;params&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span>
      <span style="color: #BA2121">&quot;fq&quot;</span><span style="color: #666666">:</span> <span style="color: #666666">[</span> <span style="color: #BA2121">&quot;{!terms f=category}book&quot;</span> <span style="color: #666666">]</span>
    <span style="color: #666666">}</span>
  <span style="color: #666666">},</span>
  <span style="color: #666666">{</span>
    <span style="color: #BA2121">&quot;store&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;commonFeatureStore&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;originalScore&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;class&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;org.apache.solr.ltr.feature.OriginalScoreFeature&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;params&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{}</span>
  <span style="color: #666666">}</span>
<span style="color: #666666">]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example: /path/leftModel.json</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #666666">{</span>
  <span style="color: #BA2121">&quot;store&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;commonFeatureStore&quot;</span><span style="color: #666666">,</span>
  <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;leftModel&quot;</span><span style="color: #666666">,</span>
  <span style="color: #BA2121">&quot;class&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;org.apache.solr.ltr.model.LinearModel&quot;</span><span style="color: #666666">,</span>
  <span style="color: #BA2121">&quot;features&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">[</span>
    <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;documentRecency&quot;</span> <span style="color: #666666">},</span>
    <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;isBook&quot;</span> <span style="color: #666666">},</span>
    <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;originalScore&quot;</span> <span style="color: #666666">}</span>
  <span style="color: #666666">],</span>
  <span style="color: #BA2121">&quot;params&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span>
    <span style="color: #BA2121">&quot;weights&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span>
      <span style="color: #BA2121">&quot;documentRecency&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">0.1,</span>
      <span style="color: #BA2121">&quot;isBook&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">1.0,</span>
      <span style="color: #BA2121">&quot;originalScore&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">0.5</span>
    <span style="color: #666666">}</span>
  <span style="color: #666666">}</span>
<span style="color: #666666">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example: /path/rightModel.json</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #666666">{</span>
  <span style="color: #BA2121">&quot;store&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;commonFeatureStore&quot;</span><span style="color: #666666">,</span>
  <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;rightModel&quot;</span><span style="color: #666666">,</span>
  <span style="color: #BA2121">&quot;class&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;org.apache.solr.ltr.model.LinearModel&quot;</span><span style="color: #666666">,</span>
  <span style="color: #BA2121">&quot;features&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">[</span>
    <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;documentRecency&quot;</span> <span style="color: #666666">},</span>
    <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;isBook&quot;</span> <span style="color: #666666">},</span>
    <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;originalScore&quot;</span> <span style="color: #666666">}</span>
  <span style="color: #666666">],</span>
  <span style="color: #BA2121">&quot;params&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span>
    <span style="color: #BA2121">&quot;weights&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span>
      <span style="color: #BA2121">&quot;documentRecency&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">1.0,</span>
      <span style="color: #BA2121">&quot;isBook&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">0.1,</span>
      <span style="color: #BA2121">&quot;originalScore&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">0.5</span>
    <span style="color: #666666">}</span>
  <span style="color: #666666">}</span>
<span style="color: #666666">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="LearningToRank-Modelevolution">Model evolution</h4>
<div class="ulist">
<ul>
<li>
<p><code>linearModel201701</code> uses features from <code>featureStore201701</code></p>
</li>
<li>
<p><code>treesModel201702</code> uses features from <code>featureStore201702</code></p>
</li>
<li>
<p><code>linearModel201701</code> and <code>treesModel201702</code> and their feature stores can co-exist whilst both are needed.</p>
</li>
<li>
<p>When <code>linearModel201701</code> has been deleted then <code>featureStore201701</code> can also be deleted.</p>
</li>
<li>
<p>Conventions used:</p>
<div class="ulist">
<ul>
<li>
<p><code>&lt;store&gt;.json</code> file contains features for the <code>&lt;store&gt;</code> feature store</p>
</li>
<li>
<p><code>&lt;model&gt;.json</code> file contains model name <code>&lt;model&gt;</code></p>
</li>
<li>
<p>a 'generation' id (e.g. <code>YYYYMM</code> year-month) is part of the feature store and model names</p>
</li>
<li>
<p>The model&#8217;s features and weights are sorted alphabetically by name, this makes it easy to see what the commonalities and differences between the two models are.</p>
</li>
<li>
<p>The stores features are sorted alphabetically by name, this makes it easy to see what the commonalities and differences between the two feature stores are.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example: /path/featureStore201701.json</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #666666">[</span>
  <span style="color: #666666">{</span>
    <span style="color: #BA2121">&quot;store&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;featureStore201701&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;documentRecency&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;class&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;org.apache.solr.ltr.feature.SolrFeature&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;params&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span>
      <span style="color: #BA2121">&quot;q&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;{!func}recip( ms(NOW,last_modified), 3.16e-11, 1, 1)&quot;</span>
    <span style="color: #666666">}</span>
  <span style="color: #666666">},</span>
  <span style="color: #666666">{</span>
    <span style="color: #BA2121">&quot;store&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;featureStore201701&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;isBook&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;class&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;org.apache.solr.ltr.feature.SolrFeature&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;params&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span>
      <span style="color: #BA2121">&quot;fq&quot;</span><span style="color: #666666">:</span> <span style="color: #666666">[</span> <span style="color: #BA2121">&quot;{!terms f=category}book&quot;</span> <span style="color: #666666">]</span>
    <span style="color: #666666">}</span>
  <span style="color: #666666">},</span>
  <span style="color: #666666">{</span>
    <span style="color: #BA2121">&quot;store&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;featureStore201701&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;originalScore&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;class&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;org.apache.solr.ltr.feature.OriginalScoreFeature&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;params&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{}</span>
  <span style="color: #666666">}</span>
<span style="color: #666666">]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example: /path/linearModel201701.json</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #666666">{</span>
  <span style="color: #BA2121">&quot;store&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;featureStore201701&quot;</span><span style="color: #666666">,</span>
  <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;linearModel201701&quot;</span><span style="color: #666666">,</span>
  <span style="color: #BA2121">&quot;class&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;org.apache.solr.ltr.model.LinearModel&quot;</span><span style="color: #666666">,</span>
  <span style="color: #BA2121">&quot;features&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">[</span>
    <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;documentRecency&quot;</span> <span style="color: #666666">},</span>
    <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;isBook&quot;</span> <span style="color: #666666">},</span>
    <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;originalScore&quot;</span> <span style="color: #666666">}</span>
  <span style="color: #666666">],</span>
  <span style="color: #BA2121">&quot;params&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span>
    <span style="color: #BA2121">&quot;weights&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span>
      <span style="color: #BA2121">&quot;documentRecency&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">0.1,</span>
      <span style="color: #BA2121">&quot;isBook&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">1.0,</span>
      <span style="color: #BA2121">&quot;originalScore&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">0.5</span>
    <span style="color: #666666">}</span>
  <span style="color: #666666">}</span>
<span style="color: #666666">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example: /path/featureStore201702.json</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #666666">[</span>
  <span style="color: #666666">{</span>
    <span style="color: #BA2121">&quot;store&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;featureStore201702&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;isBook&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;class&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;org.apache.solr.ltr.feature.SolrFeature&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;params&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span>
      <span style="color: #BA2121">&quot;fq&quot;</span><span style="color: #666666">:</span> <span style="color: #666666">[</span> <span style="color: #BA2121">&quot;{!terms f=category}book&quot;</span> <span style="color: #666666">]</span>
    <span style="color: #666666">}</span>
  <span style="color: #666666">},</span>
  <span style="color: #666666">{</span>
    <span style="color: #BA2121">&quot;store&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;featureStore201702&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;originalScore&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;class&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;org.apache.solr.ltr.feature.OriginalScoreFeature&quot;</span><span style="color: #666666">,</span>
    <span style="color: #BA2121">&quot;params&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{}</span>
  <span style="color: #666666">}</span>
<span style="color: #666666">]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example: /path/treesModel201702.json</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span style="color: #666666">{</span>
  <span style="color: #BA2121">&quot;store&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;featureStore201702&quot;</span><span style="color: #666666">,</span>
  <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;treesModel201702&quot;</span><span style="color: #666666">,</span>
  <span style="color: #BA2121">&quot;class&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;org.apache.solr.ltr.model.MultipleAdditiveTreesModel&quot;</span><span style="color: #666666">,</span>
  <span style="color: #BA2121">&quot;features&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">[</span>
    <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;isBook&quot;</span> <span style="color: #666666">},</span>
    <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;name&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;originalScore&quot;</span> <span style="color: #666666">}</span>
  <span style="color: #666666">],</span>
  <span style="color: #BA2121">&quot;params&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span>
    <span style="color: #BA2121">&quot;trees&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">[</span>
      <span style="color: #666666">{</span>
        <span style="color: #BA2121">&quot;weight&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;1&quot;</span><span style="color: #666666">,</span>
        <span style="color: #BA2121">&quot;root&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span>
          <span style="color: #BA2121">&quot;feature&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;isBook&quot;</span><span style="color: #666666">,</span>
          <span style="color: #BA2121">&quot;threshold&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;0.5&quot;</span><span style="color: #666666">,</span>
          <span style="color: #BA2121">&quot;left&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;value&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;-100&quot;</span> <span style="color: #666666">},</span>
          <span style="color: #BA2121">&quot;right&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span>
            <span style="color: #BA2121">&quot;feature&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;originalScore&quot;</span><span style="color: #666666">,</span>
            <span style="color: #BA2121">&quot;threshold&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;10.0&quot;</span><span style="color: #666666">,</span>
            <span style="color: #BA2121">&quot;left&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;value&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;50&quot;</span> <span style="color: #666666">},</span>
            <span style="color: #BA2121">&quot;right&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span> <span style="color: #BA2121">&quot;value&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;75&quot;</span> <span style="color: #666666">}</span>
          <span style="color: #666666">}</span>
        <span style="color: #666666">}</span>
      <span style="color: #666666">},</span>
      <span style="color: #666666">{</span>
        <span style="color: #BA2121">&quot;weight&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;2&quot;</span><span style="color: #666666">,</span>
        <span style="color: #BA2121">&quot;root&quot;</span> <span style="color: #666666">:</span> <span style="color: #666666">{</span>
          <span style="color: #BA2121">&quot;value&quot;</span> <span style="color: #666666">:</span> <span style="color: #BA2121">&quot;-10&quot;</span>
        <span style="color: #666666">}</span>
      <span style="color: #666666">}</span>
    <span style="color: #666666">]</span>
  <span style="color: #666666">}</span>
<span style="color: #666666">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="LearningToRank-AdditionalResources">Additional Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>"Learning to Rank in Solr" presentation at Lucene/Solr Revolution 2015 in Austin:</p>
<div class="ulist">
<ul>
<li>
<p>Slides: <a href="http://www.slideshare.net/lucidworks/learning-to-rank-in-solr-presented-by-michael-nilsson-diego-ceccarelli-bloomberg-lp" class="bare">http://www.slideshare.net/lucidworks/learning-to-rank-in-solr-presented-by-michael-nilsson-diego-ceccarelli-bloomberg-lp</a></p>
</li>
<li>
<p>Video: <a href="https://www.youtube.com/watch?v=M7BKwJoh96s" class="bare">https://www.youtube.com/watch?v=M7BKwJoh96s</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>

<!-- Adds tags, if any -->
    <div class="tags">
        
    </div>

<!-- Adds nav links on each page -->
    
    
    <div class="scrollnav">
      
      <a class="btn btn-primary prev" href="query-re-ranking.html">Query Re-Ranking</a>
      
      
      <a class="btn btn-primary next" href="transforming-result-documents.html">Transforming Result Documents</a>
      
    </div>
    

</div>

<!-- Adds comments from Apache's Comment system -->

<div id="comments_thread">
</div>
<script type="text/javascript" src="https://comments.apache.org/show_comments.lua?site=solrcwiki&style=https://home.apache.org/~ctargett/RefGuidePOC/jekyll/css/comments.css&page=learning-to-rank" async="true">
</script>
<noscript>
<iframe width="100%" height="500" src="https://comments.apache.org/iframe.lua?site=solrcwiki&style=https://home.apache.org/~ctargett/RefGuidePOC/jekyll/css/comments.css&page=learning-to-rank"></iframe>
</noscript>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2017 Apache Software Foundation. All rights reserved. <br />
 Site last generated: 2017-04-26 <br />
<p><img src="solr-sunOnly-small.png" alt="Apache Solr"/></p>
                </div>
            </div>
</footer>


    </div>
    <!-- /.row -->
  </div>
  <!-- /.container -->
</div>

</body>

</html>
